<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>McLuhan.js Source: media/map.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.benly.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">McLuhan.js</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Cassette.html">Cassette</a>
						</li>
						
						<li>
							<a href="Film.html">Film</a>
						</li>
						
						<li>
							<a href="Hack.html">Hack</a>
						</li>
						
						<li>
							<a href="Lattice.html">Lattice</a>
						</li>
						
						<li>
							<a href="Log.html">Log</a>
						</li>
						
						<li>
							<a href="Manager.html">Manager</a>
						</li>
						
						<li>
							<a href="Map.html">Map</a>
						</li>
						
						<li>
							<a href="Medium.html">Medium</a>
						</li>
						
						<li>
							<a href="Paper.html">Paper</a>
						</li>
						
						<li>
							<a href="Photo.html">Photo</a>
						</li>
						
						<li>
							<a href="Presence.html">Presence</a>
						</li>
						
						<li>
							<a href="Rhythm.html">Rhythm</a>
						</li>
						
						<li>
							<a href="TextMessage.html">TextMessage</a>
						</li>
						
						<li>
							<a href="Voice.html">Voice</a>
						</li>
						
						<li>
							<a href="Wall.html">Wall</a>
						</li>
						
						<li>
							<a href="Window.html">Window</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: media/map.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">var util = require('util');
var Medium = require('../core/medium')

/**
 * @class Map
 * @constructor
 * @description  Performative GOOGLE MAP media element
 * @extends Medium
 * @param  {object} Params (see Params)
 * @return {Paper}
 */
var Map = module.exports = function(params) {

	this.defaultSize = { w: m.stage.w, h: m.stage.h }
	this.type = "div";

	//separate item constructor "Medium" with properties for placement, animation, remove, make dom element, styling element based on json
	Medium.call(this, params);

	this.map = []
	this.directionsDisplay = [] 

	/* create map */
	var mapOptions = {
		zoom: 8,
		center: new google.maps.LatLng(0, 0),
		disableDefaultUI: true
	};
	for (var i=0;i&lt;this.element.length;i++) {
		this.map.push(new google.maps.Map(this.element[i],
	  		mapOptions));
	 	this.directionsDisplay.push(new google.maps.DirectionsRenderer())
		this.directionsDisplay[i].setMap(this.map[i])
	}

	/* helps find new locations */
	this.geocoder = new google.maps.Geocoder();

	
	this.directionsService = new google.maps.DirectionsService();

	this.location;

	this.markers = []
	this.popups = []

/*	var marker = new google.maps.Marker({
	  position: new google.maps.LatLng(-34.397, 150.644),
	  map: map,
	  animation: google.maps.Animation.DROP,
	  title: 'Hello World!'
	}); */

	/* directions stuff
	 this.directionsDisplay = new google.maps.DirectionsRenderer();
	 this.directionsService = new google.maps.DirectionsService();
	 console.log(this.map[0])
	 this.directionsDisplay.setMap();
	*/

	// this.route()

	//google.maps.event.addDomListener(window, 'load', this.initialize.bind(this));

}

util.inherits(Map, Medium);

Map.prototype.search = function(loc) {

  this.geocoder.geocode( { 'address': loc}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
    	this.location = results[0].geometry.location
        this.goto(this.location)
    }
  }.bind(this));

}

Map.prototype.goto = function(loc) {
	if (loc) {
		this.location = loc
	}
    for (var i=0;i&lt;this.map.length;i++) {
        this.map[i].setCenter(this.location);
    }
}

Map.prototype.stray = function(x,y) {
	//console.log(this.map[0].zoom)
	//console.log(this.widget)
	var scale = Math.floor(Math.pow(19/this.map[0].zoom,3))/2
	var relloc = {
		lat: this.location.A + y * scale,
		lng: this.location.F + x * scale
	}

//	this.relloc = new google.maps.Geocoder();
//	this.location.A += x;
//	this.location.F += y;
    for (var i=0;i&lt;this.map.length;i++) {
        this.map[i].setCenter(relloc);
    }
}

/* directions stuff */
Map.prototype.route = function(start, end) {
  start = start ? start : "Charlottesville, VA"
  end = end ? end : "Missoula, MT"
  var request = {
      origin:start,
      destination:end,
      travelMode: google.maps.TravelMode.DRIVING
  };
  this.directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
		for (var i=0;i&lt;this.directionsDisplay.length;i++) {
			this.directionsDisplay[i].setDirections(response);
		}
    }
  }.bind(this));
}

Map.prototype.zoom = function(level) {
	level +=3 ;
	//console.log ("zoom to "+level)
    for (var i=0;i&lt;this.map.length;i++) {
		this.map[i].setZoom(level);
	}
}

Map.prototype.marker = function() {

  // if no argument, goes to this.location
  // otherwise, jumps to new place and places marker w/ bounce
  // markers is an array of arrays, with infowin attached to each
  // a text field to define where each new one will go...
  // no way to remove old ones, unless i create a new button in the rack.
  // 
  // 
  // 
  // how to remove them?
  // 

  //this.geocoder.geocode( { 'address': loc}, function(results, status) {
  //  if (status == google.maps.GeocoderStatus.OK) {
	    for (var i=0;i&lt;this.map.length;i++) {
	        this.markers[i] = new google.maps.Marker({
	            map: this.map[i],
	            position: this.location
	        })
	    }
  //  }
  //}.bind(this));

}


Map.prototype.info = function(content) {

  var contentString = content ? content : '&lt;div style="color:black;width:100px;height:100px;background-color:black;display:block">888&lt;/div>';

  for (var i=0;i&lt;this.map.length;i++) {
  	
  	this.popups[i] = new google.maps.InfoWindow({
      content: contentString
  	});

  	this.popups[i].open(this.map[i],this.markers[i]);

  }

}


</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					McLuhan.js
					<br />
					
					
		<span class="copyright">
		Ben Taylor &copy; 2015
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a>
		on Sun Sep 13 2015 15:39:43 GMT-0500 (CDT) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
