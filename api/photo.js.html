<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>McLuhan.js Source: media/photo.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.benly.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">McLuhan.js</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Cassette.html">Cassette</a>
						</li>
						
						<li>
							<a href="Film.html">Film</a>
						</li>
						
						<li>
							<a href="Hack.html">Hack</a>
						</li>
						
						<li>
							<a href="Lattice.html">Lattice</a>
						</li>
						
						<li>
							<a href="Manager.html">Manager</a>
						</li>
						
						<li>
							<a href="Medium.html">Medium</a>
						</li>
						
						<li>
							<a href="Paper.html">Paper</a>
						</li>
						
						<li>
							<a href="Photo.html">Photo</a>
						</li>
						
						<li>
							<a href="Presence.html">Presence</a>
						</li>
						
						<li>
							<a href="Rhythm.html">Rhythm</a>
						</li>
						
						<li>
							<a href="Voice.html">Voice</a>
						</li>
						
						<li>
							<a href="Wall.html">Wall</a>
						</li>
						
						<li>
							<a href="Window.html">Window</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: media/photo.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">var util = require('util');
var Medium = require('../core/medium')

/**
 * @class Photo
 * @constructor
 * @description  Performative IMAGE media element
 * @extends Medium
 * @param  {object} Params (see Params)
 * @return {Photo}
 */
var Photo = module.exports = function(params) {

	this.defaultSize = { w: 800 }
	this.type = "canvas";

	//separate item constructor "Medium" with properties for placement, animation, remove, make dom element, styling element based on json
	Medium.call(this, params);

	this.context = []

	for (var i = 0; i&lt;this.spaces.length; i++) {
		this.context.push(this.element[i].getContext("2d"))
	}

	this.width = 0;
	this.height = 0;

	this.zoomstate = {
		x: 0,
		y: 0,
		level: 1
	}

	/* create hidden canvas */

	this.master = document.createElement("canvas")
	this.master.style.display = "none"
	document.body.appendChild(this.master)
	this.mastercontext = this.master.getContext("2d")


}

util.inherits(Photo, Medium);

/*
THE PLAN
as it is now -- new Image(), one canvas
the glitch is controlled (has stable seed, only glitches original image)
	except, does not glitch an image, glitches a canvas.
in end, glitch result must be copied using drawImage()
and, don't want to glitch each step of resize process...

or
hidden canvas with original image, glitches, 
can glitch that one
always copy it over, use putimagedata
can *sort of* zoome with putimagedata

or

can drawImage(canvas)
never use drawimage (except the first time)
always use get image data and putimagedata
always transform the current thing
still have original data in background if wish to reset
&lt;&lt;&lt;
because transforming existing transformations is interesting, apparently


 */

Photo.prototype.load = function(src) {

	this.image = new Image()
	this.image.onload = function() {
		this.width = this.image.width;
		this.height = this.image.height

		this.master.width = this.width;
		this.master.height = this.height;
		this.master.style.width = this.width;
		this.master.style.height = this.height;
		this.mastercontext.drawImage(this.image,0,0)

		for (var i=0;i&lt;this.context.length;i++) {
			this.element[i].width = this.width;
			this.element[i].height = this.height;
			this.element[i].style.width = this.width;
			this.element[i].style.height = this.height;
		}
		this.propogateMaster();

		//this.data = this.context[0].getImageData( 0, 0, this.width, this.height );
		// dealing with image data
		/*this.data = {
			original: this.context[0].getImageData( 0, 0, this.width, this.height ),
			current: 0
		}*/

	}.bind(this)
	this.image.src = "images/"+src+".jpg"

	return this;

}

Photo.prototype.propogateMaster = function() {
	for (var i=0;i&lt;this.context.length;i++) {
		this.context[i].drawImage(this.master, this.zoomstate.x, this.zoomstate.y,this.zoomstate.level*this.width,this.zoomstate.level*this.height,0,0,this.width,this.height );
	}
}

Photo.prototype.glitch = function(file,callback) {
	this.data = this.mastercontext.getImageData( 0, 0, this.width, this.height );

	// glitch the image data (passing drawImageDataInCanvasTwo as a callback function)
	var parameters = { amount: 10, seed: 1, iterations: 10, quality: 30 };
	
	//console.log(parameters)
	//console.log(glitch)
	
	glitch( this.data, parameters, function(data) {
		this.mastercontext.putImageData( data, 0, 0 );
		this.propogateMaster();
	}.bind(this));
		
}

Photo.prototype.zoom = function(params) {
	if (params.level) {
		this.zoomstate.level = params.level
	}
	if (params.x) {
		this.zoomstate.x = params.x * this.width
	}
	if (params.y) {
		this.zoomstate.y = params.y * this.height
	}

	this.propogateMaster();

	/*for (var i = 0; i&lt;this.element.length; i++) {
		this.context[i].drawImage(this.image, this.zoomstate.x, this.zoomstate.y,this.zoomstate.level*this.width,this.zoomstate.level*this.height,0,0,this.width,this.height );
	} */

}</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					McLuhan.js
					<br />
					
					
		<span class="copyright">
		Ben Taylor &copy; 2015
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a>
		on Thu May 21 2015 18:02:35 GMT-0400 (EDT) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
