<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width">
	<script src="speakClient.js"></script>
	<script src="../dist/mcluhan.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Nixie+One' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Anonymous+Pro' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  </head>
  <body>

	<script>

	$(function() {

		// m.gui.setup()

		projectwid = $(".guides").width()
		projecthgt = $(".guides").height()
		showbguide = true;
		smoothguide = 0;

		window.addEventListener("resize",checkSize)

		checkSize()

		NProgress.start();
		NProgress.inc();
		
		setTimeout("NProgress.set(0.69)", 3000);
		setTimeout("NProgress.set(0.99)", 4000);
		setTimeout(NProgress.done, 5000);
		setTimeout("$('#splash').fadeOut()", 5000);

	})

	function checkSize() {
		var winwid = window.innerWidth;
		var winhgt = window.innerHeight;
		if (winwid < projectwid + 10 && winwid > projectwid - 10 && winhgt < projecthgt + 10 && winhgt > projecthgt - 10) {

			if (showbguide) {
				showbguide = false;
				$(".bguide").fadeOut(smoothguide)
				$(".sguide").fadeIn(0)
				watchWindow();
			}
		} else {
			smoothguide = 500;
		}
	}

	function watchWindow() {
		sguide = setInterval(pingWindow, 50)
	}

	var wwid = window.screen.availWidth;
	var whgt = window.screen.availHeight;

	function pingWindow() {
		var winx = window.screenLeft;
		var winy = window.screenTop;
		var winwid2 = window.outerWidth;
		var winhgt2 = window.outerHeight;

		var distx = winx + (winwid2/2) - (wwid/2)
		var disty = winy + (winhgt2/2) - (whgt/2)

		var polar = m.toPolar(distx,disty)
		var degrees = Math.round((polar.angle/(Math.PI*2)) * 360) + 180;
		var size = (Math.round(polar.radius)/6)+10

		$("#sgarrow").css("-ms-transform", "rotate("+degrees+"deg)")
		$("#sgarrow").css("-webkit-transform", "rotate("+degrees+"deg)")
		$("#sgarrow").css("transform", "rotate("+degrees+"deg)")
		$("#sgarrow").css("font-size", size+"px")

		if (Math.abs(distx) < 20 && Math.abs(disty) < 20 ) {
			$(".sguide").fadeOut(smoothguide)
			clearInterval(sguide)
		} else {
			smoothguide = 500
		}

	}
		

	m.deck(16);

	m.timeline = function(scheduler) {
	  switch(scheduler) {
		case 10: 
		  a = new wall("line");
			break;
		case 30: 
		  a.a = a.watch("ocean")
			break;
		case 50: 
		  a.xray()
			break;
		case 70: 
		  a.a.skip(6,8)
			break;
	  }
	}

	window.addEventListener("beforeunload", function() {
		m.deck(m.spaceLimit);
	});

	
	</script>

	<div style="position:absolute;top:0px;width:100%;height:100%">
		<div class="guides">

			<h1>FILM<h1>

			<button onclick="m.start(0,1000);">Let's Go!</button>

			<footer>Lovingly made with McLuhan.js</footer>

			<div class="sguide" style="display:none">
				Please move your browser to the middle of your screen.
				<div id="sgarrow" style="font-size:70px;margin-top:40px">&#10148;</div>

			</div>
			<div class="bguide">
				Please resize your browser to the size of this box.
			</div>
		</div>
	</div>


	<div id="splash">
		<span>M</span>
	</div>

	<!-- 
	preparation section!
	// please make your browser this big (show guides)
	// move it to center of screen (show arrow!)
	// nice alert when done
	back button that redecks when leaving page
	show x and y distances in setup gui arrow task
	need a close all windows function with a callback function...
	-->

  </body>
</html>